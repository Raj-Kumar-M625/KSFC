@model KAR.KSFC.Components.Common.Dto.IDM.InspectionOfUnit.IdmDchgLandDetDTO

@{
    Layout = null;
    var accNumber = ViewBag.LoanAcc;
    var inspectionId = ViewBag.InspectionId;
    var firstinspection = ViewBag.firstbuildinginspection;
    var land = ViewBag.landInspectionDetails;
}


<div>
    <div>
        <form id="LandInspectionDetailsAd" asp-action="Create" asp-controller="LandInspectionAd" onsubmit="return JqueryInspectionAddMethod(this,'LandInspectionAd'); ClearPopupFormsh();">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input type="hidden" value="@accNumber" asp-for="LoanAcc" />
            <input type="hidden" value="@inspectionId" asp-for="DcLndIno" />
            <input type="hidden" value="@ViewBag.LoanSub" asp-for="LoanSub" />
            <input type="hidden" value="@ViewBag.OffcCd" asp-for="OffcCd" />
            @*  @Html.HiddenFor(m => m.IrlId)*@

            @Html.HiddenFor(m => m.Action, new { @class = "form-control"})

            <div class="row">
                <div class="col-md-4">
                    <strong><label class="form-label">Land Ref No<span id="spanDet1"> *</span></label></strong>
                    @Html.TextBoxFor(m => m.DcLndrefNo, new { @class = "form-control",@maxlength = "10", @id = "reviseLdArea", @readonly = "true"})
                    <span asp-validation-for="DcLndrefNo" class="text-danger"></span>
                </div>
                <div class="col-md-4">
                    <strong><label class="form-label">Revised Land Area<span id="spanDet1"> *</span></label></strong>
                    @Html.TextBoxFor(m => m.DcLndArea, new { @class = "form-control",@maxlength = "10", @id = "reviseLdArea", @required = "required"})
                    <span asp-validation-for="DcLndArea" class="text-danger"></span>
                </div>
                <div class="col-md-4">
                    <strong><label class="form-label">Security Created<span id="spanDet1"> *</span></label></strong>
                    @Html.TextBoxFor(m => m.DcLndSecCreated, new { @class = "form-control",
                    @onkeypress="return (event.charCode !=8 && event.charCode == 0 || (event.charCode >= 48 && event.charCode <= 57))",@maxlength = "9", @id = "secCreated",readOnly="true"})
                    <span asp-validation-for="DcLndSecCreated" class="text-danger"></span>
                </div>
            </div>
            <br />
            <div class="row">
                <div class="col-md-4">
                    <strong><label class="form-label">Type Of Land<span id="spanDet1"> *</span></label></strong>
                    @Html.DropDownListFor(m => m.DcLndType, new SelectList(@ViewBag.LandType, "Value", "Text"),"---Select Type Of Land---", new { @class = "form-select", @id = "LandType",@required = "required"})
                    <span asp-validation-for="DcLndType" class="text-danger"></span>
                </div>
                <div class="col-md-4">
                    <strong><label class="form-label">Cost Of Land<span id="spanDet1"> *</span></label></strong>
                    @Html.TextBoxFor(m => m.DcLndAmt,"{0:n2}", new { @class = "form-control",
                    @onkeypress="return (event.charCode !=8 && event.charCode == 0 || (event.charCode >= 48 && event.charCode <= 57))",@maxlength = "13", @id = "costLand",@required = "required" ,@style="text-align:right"})
                    <span asp-validation-for="DcLndAmt" class="text-danger"></span>
                </div>
                <div class="col-md-4">
                    <strong><label class="form-label">Cost Of Land Development<span id="spanDet1"> *</span></label></strong>
                    @Html.TextBoxFor(m => m.DcLndDevCst, "{0:n2}", new { @class = "form-control" , @style="text-align:right",
                    @onkeypress="return (event.charCode !=8 && event.charCode == 0 || (event.charCode >= 48 && event.charCode <= 57))",@maxlength = "13", @id = "costDevLand",@required = "required" })
                    <span asp-validation-for="DcLndDevCst" class="text-danger"></span>
                </div>
            </div>
            <br />
            <div class="row">
                @* <div class="col-md-4">
                <strong><label class="form-label">Land Financed (Y/N)</label></strong>
                @Html.DropDownListFor(m => m.DcLndLandFinance, new List<SelectListItem>()
                {
                new SelectListItem(){Text="YES",Value = "1"},
                new SelectListItem(){Text="NO",Value = "0"}
                },"---Select Land Financed---", new { @class = "form-select", @id = "LdFin"})
                <span asp-validation-for="DcLndLandFinance" class="text-danger"></span>
                </div>*@
                @* <div class="col-md-4">
                <strong><label class="form-label">Acquisition Status(Y/N)<span id="spanDet1"> *</span></label></strong>
                @Html.DropDownListFor(m => m.DcLndAqrdIndicator, new List<SelectListItem>()
                {
                new SelectListItem(){Text="Not Acquired",Value = "0"},
                new SelectListItem(){Text="Partially Acquired",Value = "1"},
                new SelectListItem(){Text="Acquired",Value = "2"}
                },"---Select Acquisition Status---", new { @class = "form-select", @id = "AcqStg",@required = "required"})
                <span asp-validation-for="DcLndAqrdIndicator" class="text-danger"></span>
                </div>*@
                @* <div class="col-md-4">
                <strong><label class="form-label">Acquired Date<span id="spanDet1"> *</span></label></strong>
                @Html.TextBoxFor(m => m.DcLndStatChgDate, "{0:yyyy-MM-dd}", new { @class = "form-control",@id = "Acqdate", type="date",onkeydown="return false", @readonly = "true",@required = "required"})
                <span asp-validation-for="DcLndStatChgDate" class="text-danger"></span>
                </div>*@
            </div>
            <br />

            <div class="row">
                <div class="col-md-4">
                    <strong><label class="form-label">Land Development Details<span id="spanDet1"> *</span></label></strong>
                    @Html.TextAreaFor(m => m.DcLndDets, new { @class = "form-control",@maxlength = "200", @id = "ldDevDt", @required = "required"})
                    <span id="spanDet">Max: 200 Characters</span><br />
                    <span asp-validation-for="DcLndDets" class="text-danger"></span>
                </div>
                <div class="col-md-4">
                    <strong><label class="form-label">Security Considered for Release</label></strong>
                    @Html.TextBoxFor(m => m.DcLndSecCreated, new { @class = "form-control", @id = "secrelease",
                    @onkeypress="return (event.charCode !=8 && event.charCode == 0 || (event.charCode >= 48 && event.charCode <= 57))",@maxlength = "13",@style="text-align:right"})
                    <span asp-validation-for="DcLndSecCreated" class="text-danger"></span>
                </div>
            </div>
            <br />

            <div @*id="landAcquisition" style="display:none;"*@>
                <p><h4>Land Release Details</h4></p>
                <div class="row">
                    <div class="col-md-4">
                        <strong><label class="form-label">Actual Land Unit Area</label></strong>
                        @Html.TextBoxFor(m => m.IrlAreaIn, new { @class = "form-control", @id = "ldAreain" })

                        <span asp-validation-for="IrlAreaIn" class="text-danger"></span>
                    </div>
                    <div class="col-md-4">
                        <strong><label class="form-label">Land Financed (Y/N)</label></strong>
                        @* @Html.DropDownListFor(m => m.DcLndLandFinance, new List<SelectListItem>()
                        {
                        new SelectListItem(){Text="YES",Value = "1"},
                        new SelectListItem(){Text="NO",Value = "0"}
                        },"---Select Land Financed---", new { @class = "form-select", @id = "LdFin",@readOnly="true"})
                        <span asp-validation-for="DcLndLandFinance" class="text-danger"></span>  *@
                        @Html.TextBoxFor(m => m.DcLndLandFinance, new { @class = "form-control", @id = "LdFin",@readOnly="true" })
                        <span asp-validation-for="DcLndLandFinance" class="text-danger"></span>
                    </div>
                    <div class="col-md-4">
                        <strong><label class="form-label">Acquisition Status(Y/N)<span id="spanDet1"> *</span></label></strong>
                        @Html.DropDownListFor(m => m.DcLndAqrdIndicator, new List<SelectListItem>()
                        {
                        new SelectListItem(){Text="Not Acquired",Value = "0"},
                        new SelectListItem(){Text="Partially Acquired",Value = "1"},
                        new SelectListItem(){Text="Acquired",Value = "2"}
                        },"---Select Acquisition Status---", new { @class = "form-select", @id = "AcqStg",@required = "required"})
                        <span asp-validation-for="DcLndAqrdIndicator" class="text-danger"></span>
                    </div>
                </div>
                <br />
                <div class="row">
                    <div class="col-md-4">
                        <strong><label class="form-label">Release Status(%)</label></strong>
                        @* @Html.TextBoxFor(m => m.IrlRelStat, new { @class = "form-control",@type="number",readOnly="true",
                        @oninput="this.value=this.value.slice(0,this.maxLength)",
                        @maxlength = "10", @id = "IrlRelStat"})*@
                        @Html.DropDownListFor(m => m.IrlRelStat, new List<SelectListItem>()
                        {
                        new SelectListItem(){Text="No Release Yet",Value = "0"},
                        new SelectListItem(){Text="Partially Released",Value = "1"},
                        new SelectListItem(){Text="Fully Released",Value = "2"}
                        },"---Select Release Status---", new { @class = "form-select", @id = "IrlRelStat",@required = "required"})
                        <span asp-validation-for="IrlRelStat" class="text-danger"></span>
                    </div>
                    <div class="col-md-4">
                        <strong><label class="form-label">Security Considered for Release</label></strong>
                        @Html.TextBoxFor(m => m.IrlSecValue, new { @class = "form-control", @id = "secrelease",
                        @onkeypress="return (event.charCode !=8 && event.charCode == 0 || (event.charCode >= 48 && event.charCode <= 57))",@maxlength = "13",@style="text-align:right"})
                        <span asp-validation-for="IrlSecValue" class="text-danger"></span>
                    </div>
                    <div class="col-md-4">
                        <strong><label class="form-label">Acquired Date<span id="spanDet1"> *</span></label></strong>
                        @Html.TextBoxFor(m => m.DcLndStatChgDate, "{0:yyyy-MM-dd}", new { @class = "form-control",@id = "Acqdate", type="date",onkeydown="return false", @readonly = "true",@required = "required"})
                        <span asp-validation-for="DcLndStatChgDate" class="text-danger"></span>
                    </div>
                </div>
                <br />
            </div>


            <div class="form-group">
                <div class="col-md-2 text-center float-end submit5">
                    <input type="submit" value="Submit" class="btn btn-primary" disabled="disabled" id="submit" />
                </div>
            </div>
            <br />
        </form>
    </div>
</div>


<script>
    $('input[class="form-control"],textarea[class="form-control"],select[class="form-select"]').change(function () {
        if ($(this).val()) {
            $("input[id='submit']").removeAttr('disabled');
        }
    });



    $("#AcqStg").change(function () {
        debugger;
        var status = $('#AcqStg :selected').val();
        if (status == 1 || status == 2) {
            // document.getElementById('Acqdate').readOnly = false
            $("#landAcquisition").show();
        }
        else {
            $("#AcqStg").click(function () {
                //$("#Acqdate").val("0");
            });
            $("#landAcquisition").hide();
            //document.getElementById('Acqdate').readOnly = true
        }
    });

    var maxDate = new Date().toISOString().split('T')[0];
    document.getElementById('Acqdate').value = maxDate



    $("#secrelease").change(function () {
        debugger;
        var secamt = ($("#secrelease").val());
        var land = ($("#secCreated").val());
        var ratio = (secamt / land) * 100;
        //$("#IrlRelStat").val(Math.round(ratio));
    });




    //debugger;
    //if ('@ViewBag.firstbuildinginspection' === 'True') {
    //    console.log('@ViewBag.firstbuildinginspection')
    //    Swal.fire({
    //        title: 'Are you sure Want To Add?',
    //        text: 'Land Inspection Details is not Added in Previous Inspection',
    //        icon: 'warning',
    //        showCancelButton: true,
    //        confirmButtonText: 'Yes',
    //        cancelButtonText: 'No',
    //    }).then((result) => {
    //        // If the user clicks "Yes"
    //        if (result.isConfirmed) {
    //            // Open the form
    //            $('#LandInspectionDetails').show();
    //        }
    //        else {
    //            $('#modelLandInspectionDetails .modal-body').html('');
    //            $('#modelLandInspectionDetails .modal-title').html('');
    //            $('#modelLandInspectionDetails').modal('hide');
    //        }
    //    });

    //}

    Swal.fire({
        text: "Modification of deed is pending and it needs to be done before the last 10% of the Disbursement.",
        icon: 'warning',
        showDenyButton: true,
        showCancelButton: true,
        confirmButtonText: 'Yes',
        cancelButtonText: 'No',
        denyButtonText: "Don't save"
    })



</script>

<script>




    var MacNo = "@ViewBag.landInspectionDetails";
    $("#secCreated").val(MacNo)
    var release = "@ViewBag.releasedetails";
    $("#secrelease").val(release)
    var ratio = (release / MacNo) * 100;
    //$("#IrlRelStat").val(Math.round(ratio))


</script>

<script>
    debugger;
    if ("@ViewBag.landInspectionDetails" != "") {

        $("#costLand").on("change", function () {
            debugger
            var sec = ($("#costLand").val())
            var land = "@ViewBag.landInspectionDetails";
            var cost = parseInt(sec);
            var lands = parseInt(land);
            var total = (lands + cost);
            $("#secCreated").val(total)
            var land = ($("#secCreated").val())
            var secamt = ($("#secrelease").val())
            var ratio = (secamt / land) * 100;
            //$("#IrlRelStat").val(Math.round(ratio))

        })


    }
    if ("@ViewBag.landInspectionDetails" === "") {
        $("#costLand").on("change", function () {
            //debugger
            var sec = ($("#costLand").val());
            $("#secCreated").val(sec);
            var land = ($("#secCreated").val());
            var secamt = ($("#secrelease").val());
            var ratio = (secamt / land) * 100;
            //$("#IrlRelStat").val(Math.round(ratio));

        });
    }

    $("#costDevLand").on("change", function () {
        debugger;
        var total = $('#secCreated').val();
        var costofLandDev = $('#costDevLand').val();
        var sec = eval(total + "+" + costofLandDev);
        $("#secCreated").val(sec);

    });


   

</script>
