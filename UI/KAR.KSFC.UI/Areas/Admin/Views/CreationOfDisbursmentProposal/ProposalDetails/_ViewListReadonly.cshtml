@*@model List<KAR.KSFC.Components.Common.Dto.IDM.CreationOfDisbursmentProposal.TblIdmReleDetlsDTO>*@
@using KAR.KSFC.Components.Common.Dto.IDM.CreationOfDisbursmentProposal
@{
    int count = 0;
    decimal deduction = 0;
    var account = ViewBag.AccountNumber;
    TblIdmReleDetlsDTO Model = ViewBag.ProposalDetails;

    var otherdbit = ViewBag.otherdebitMast;
    var dsbChargeMap = ViewBag.dsbChargeMap;

    var loansub = ViewBag.LoanSub;
    var otherdebitmast = ViewBag.otherdebitMast;
    var totatAmount = ViewBag.TotalAmount;


}


<div class="pre-scrollable">
    <table class="table table-striped table-bordered table-sm table-responsive-xl" id="tblProposalDetailsDatatableview" aria-labelledby="ProposalDetails-tab">
        <thead>
            <tr>
                <th class="th1">S. No.</th>
                <th class="th4">Type of charge</th>

                <th class="th4a">Amount</th>
                <th class="th6">Action</th>
            </tr>
        </thead>
        <tbody>

            @if (Model.ReleBnkChg != null)
            {

                count++;
                deduction += (decimal)Model.ReleBnkChg;
                <tr class="trow">
                    <td>@count</td>


                    <td>Bank Chargers</td>
                    <td align="right">@Html.DisplayFor(modelItem => Model.ReleBnkChg)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="bankcharge",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleDocChg != null)
            {
                count++;
                deduction += (decimal)Model.ReleDocChg;
                <tr class="trow">
                    <td>@count</td>

                    <td>Documentation Chargers</td>
                    <td align="right">@Html.DisplayFor(modelItem => Model.ReleDocChg)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="documentationcharge",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.AddlAmt1 != null)
            {

                count++;
                deduction += (decimal)Model.AddlAmt1;
                <tr class ="trow">
                    <td>@count</td>

                    <td>Insurance Chargers</td>
                    <td align="right">@Html.DisplayFor(modelItem => Model.AddlAmt1)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="insurancecharge",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.AddlAmt2 != null)
            {
                count++;
                deduction += (decimal)Model.AddlAmt2;
                <tr class="trow">
                    <td>@count</td>

                    <td>Legal Chargers</td>
                    <td align="right">@Html.DisplayFor(modelItem => Model.AddlAmt2)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="legalcharge",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.AddlAmt3 != null)
            {
                count++;
                deduction += (decimal)Model.AddlAmt3;
                <tr class="trow">
                    <td>@count</td>

                    <td>Penalty</td>
                    <td align="right">@Html.DisplayFor(modelItem => Model.AddlAmt3)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="penalty",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleAtParAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleAtParAmount;
                <tr class="trow">
                    <td>@count</td>

                    <td>At Par Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleAtParAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="atparamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleUpFrtAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleUpFrtAmount;
                <tr class="trow">
                    <td>@count</td>

                    <td>Up Front Charges</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleUpFrtAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="upcharge",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            
            @if (Model.ReleComChg != null)
            {
                count++;
                deduction += (decimal)Model.ReleComChg;
                <tr class="trow">
                    <td>@count</td>

                    <td>Commission Charges</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleComChg)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="commissioncharge",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            
            @if (Model.ReleFdAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleFdAmount;
                <tr class="trow">
                    <td>@count</td>

                    <td>FD Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleFdAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="fdamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleOthAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleOthAmount;
                <tr class="trow">
                    <td>@count</td>

                    <td>Other Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleOthAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="othamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleAdjAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleAdjAmount;
                <tr class="trow">
                    <td>@count</td>

                    <td>Adjustment Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleAdjAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="adjamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleAddUpFrtAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleAddUpFrtAmount;
                 <tr>
                    <td>@count</td>

                    <td>Additional UpFront Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleAddUpFrtAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="addupamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleAddlafdAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleAddlafdAmount;
                <tr class="trow">
                    <td>@count</td>

                    <td>Additional FD Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleAddlafdAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="addfdamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleSertaxAmount != null)
            {
                count++;
                deduction += (decimal)Model.ReleSertaxAmount;
                <tr class="trow">
                    <td>@count</td>

                    <td>Service Tax Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleSertaxAmount)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="servicetaxamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleCersai != null)
            {
                count++;
                 deduction += (decimal)Model.ReleCersai;
                <tr class="trow">
                    <td>@count</td>

                    <td>Cersai Amount</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleCersai)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="cersaiamt",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleSwachcess != null)
            {
                count++;
                deduction += (decimal)Model.ReleSwachcess;
                <tr class="trow">
                    <td>@count</td>

                    <td>Swach Cess</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleSwachcess)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="swachcess",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            
            @if (Model.Relekrishikalyancess != null)
            {
                count++;
                deduction += (decimal)Model.Relekrishikalyancess;
                <tr class="trow">
                    <td>@count</td>

                    <td>Krishikalyan  Cess</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.Relekrishikalyancess)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="krishicess",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.ReleCollGuaranteeFee != null)
            {
                deduction += (decimal)Model.ReleCollGuaranteeFee;
                count++;
                <tr class="trow">
                    <td>@count</td>

                    <td>Collateral Guarantee Fee</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.ReleCollGuaranteeFee)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="collguarfee",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            
            @if (Model.AddlAmt4 != null)
            {
                deduction += (decimal)Model.AddlAmt4;
                count++;
                <tr class="trow">
                    <td>@count</td>

                    <td>Additonal Amount 1</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.AddlAmt4)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="addamt1",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }
            @if (Model.AddlAmt5 != null)
            {
                deduction += (decimal)Model.AddlAmt5;
                count++;
                <tr class="trow">
                    <td>@count</td>

                    <td>Additonal Amount 2</td>
                    <td align="right">@Html.DisplayFor(modelItem =>Model.AddlAmt5)</td>

                    <td id="textCenter">
                        <a onclick="showDocumentPopup('@Url.Action("ViewChargeList","DisbursmentProposalDetails",new {bankdisc="addamt2",unqid=Model.UniqueId},Context.Request.Scheme)','View List of Charges')" class="btn btn-warning text-white"><i class="fa fa-eye" aria-hidden="true"></i>  View</a>

                    </td>
                </tr>

            }

        </tbody>
    </table>
     <div class="col-md-2 text-center float-end" style="margin-right:-2px">
        <div id="">
            <strong><label>Total Amount</label></strong>
            <input type="text"  id="totalamountview" disabled value="@(totatAmount - deduction)"  style="text-align:right"/>
        </div>

    </div>
</div>


<div id="DownloadPanel" class="even_spacing"></div>

    <script type="text/javascript">
        $(document).ready(function () {

        $('#tblProposalDetailsDatatableview').DataTable();
        });

        $(document).ready(function () {
            //debugger;
            $("#tblProposalDetailsDatatableview .trow").each(function () {
                //debugger;
                var total = 0;
                var totalvalue = ($(this).find("td:eq(2)").text());
                total = parseInt(totalvalue);
            //var res = $("#totalamountview").val();
            //    if (res > 0 || res != "") {
            //        var sum = total + parseInt(res);
            //        $("#totalamountview").val(sum);
            //    }
            //    else {
            //    $("#totalamountview").val(total);
            //    }


            });
        });
    </script>
